<!doctype html>
<html lang="italian" itemscope itemtype="http://schema.org/Person">

<head>
     <meta charset="utf-8">
    <!-- Site Meta Data -->
    <title>Build di una solution da codice</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Doc">

    <link rel="shortcut icon" href="/favicon.ico">

    <!-- schema.org -->
    <meta itemprop="name" content="ildoc's">
    <meta itemprop="image" content="">
    <meta itemprop="description" content="">

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
    <!-- Style Meta Data -->
    <link rel="stylesheet" href="https://ildoc.it/theme/pelican-blue/static/css/style.css" type="text/css" />
    <link rel="stylesheet" href="https://ildoc.it/theme/pelican-blue/static/css/pygments.css" type="text/css" />

    <!-- Feed Meta Data -->
    <link href="https://ildoc.it/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="ildoc's ATOM Feed"
    />  
    <!-- Twitter Feed -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="">
    <meta name="twitter:image" content=""> 
<meta name="twitter:creator" content="">
<meta name="twitter:url" content="https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/">
<meta name="twitter:title" content="ildoc's ~ Build di una solution da codice">
<meta name="twitter:description" content="Come seguito al post precedente, ecco una funzioncina per buildare una solution da codice. Questa funzione NON tiene conto di eventuali build configuration e/o di progetti unloadati. A mio avviso è un bug dell&#39;msbuild (e non l&#39;unico, direi), in quanto, provando a buildare la stessa solution da codice, da …">

<link rel="canonical" href="https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/" />

<!-- Facebook Meta Data -->
<meta property="og:title" content="ildoc's ~ Build di una solution da codice" />
<meta property="og:description" content="Come seguito al post precedente, ecco una funzioncina per buildare una solution da codice. Questa funzione NON tiene conto di eventuali build configuration e/o di progetti unloadati. A mio avviso è un bug dell&#39;msbuild (e non l&#39;unico, direi), in quanto, provando a buildare la stessa solution da codice, da …" />
<meta property="og:image" content="" /> </head>

<body>
    <!-- Sidebar -->
    <aside>
        <!--<center><a href="https://ildoc.it"><img id="avatar" src=""></a></center>-->
        <h1><a href="/">ildoc's</a></h1>

        <nav class="nav">
            <ul class="list-bare">

                <li><a class="nav__link" href="/">Home</a></li>
                <li><a class="nav__link" href="/archives.html">Archives</a></li>
 
            </ul>
        </nav>

        <p class="social">
             <a href="https://twitter.com/il_doc" target="_blank"><img
                        src="https://ildoc.it/theme/pelican-blue/static/images/icons/twitter.png"></a>             <a href="https://github.com/ildoc" target="_blank"><img
                        src="https://ildoc.it/theme/pelican-blue/static/images/icons/github.png"></a>               <a href="https://ildoc.it/feeds/all.atom.xml" rel="alternate">
                <img src="https://ildoc.it/theme/pelican-blue/static/images/icons/rss.png"></a>          </p>


    </aside>

    <!-- Content -->
    <article>
<section id="content">
    <article>
        <h2 class="post_title post_detail"><a href="https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/" rel="bookmark" title="Permalink to Build di una solution da codice">Build di una solution da codice</a></h2>
        <span class="post_date">gio 20 marzo 2014</span>
        <span>Tags : </span>          <span><a href="https://ildoc.it/tag/c.html">c# </a></span>         <span><a href="https://ildoc.it/tag/visual-studio.html">visual studio </a></span>         <span><a href="https://ildoc.it/tag/msdn.html">msdn </a></span>          <div class="entry-content blog-post">
            <p>Come seguito al <a href="https://ildoc.it/2014/03/07/get-latest-da-codice-di-un-progetto-su-tfs/">post
precedente</a>,
ecco una funzioncina per buildare una solution da codice.</p>
<p>Questa funzione NON tiene conto di eventuali build configuration e/o di
progetti unloadati.<br>
A mio avviso è un bug dell'msbuild (e non l'unico, direi), in quanto,
provando a buildare la stessa solution da codice, da visual studio e da
console si ottengono SEMPRE risultati diversi.</p>
<p>Ho chiesto all'inutile-come-sempre supporto msdn, ma mi solo solo fatto
del gran nervoso, ecco il
<a href="http://social.msdn.microsoft.com/Forums/vstudio/en-US/0f2bb4fc-c9dd-4dfc-8791-338ceac04c1c/remove-projects-from-a-solution-programmatically">link</a>
alla discussione.</p>
<div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">BuildSolution</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">bool</span> <span class="n">result</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="kt">string</span> <span class="n">solutionPath</span> <span class="p">=</span> <span class="s">@&quot;C:\path\della\solution.sln&quot;</span><span class="p">;</span>

        <span class="n">ProjectCollection</span> <span class="n">pc</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ProjectCollection</span><span class="p">();</span>

        <span class="c1">//definiamo le property della build (ci sono miliardi di opzioni diverse)</span>
        <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span> <span class="n">globalProperty</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;();</span>
        <span class="n">globalProperty</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Configuration&quot;</span><span class="p">,</span> <span class="s">&quot;Release&quot;</span><span class="p">);</span>
        <span class="n">globalProperty</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Platform&quot;</span><span class="p">,</span> <span class="s">&quot;Any CPU&quot;</span><span class="p">);</span>
        <span class="n">globalProperty</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;OutputPath&quot;</span><span class="p">,</span> <span class="s">&quot;bin\Debug&quot;</span><span class="p">);</span>

        <span class="n">BuildParameters</span> <span class="n">bp</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BuildParameters</span><span class="p">(</span><span class="n">pc</span><span class="p">);</span>
        <span class="n">BuildRequestData</span> <span class="n">BuidlRequest</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BuildRequestData</span><span class="p">(</span><span class="n">solutionPath</span><span class="p">,</span> <span class="n">globalProperty</span><span class="p">,</span> <span class="s">&quot;4.0&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;Build&quot;</span> <span class="p">},</span> <span class="k">null</span><span class="p">);</span>
        <span class="n">BuildResult</span> <span class="n">buildResult</span> <span class="p">=</span> <span class="n">BuildManager</span><span class="p">.</span><span class="n">DefaultBuildManager</span><span class="p">.</span><span class="n">Build</span><span class="p">(</span><span class="n">bp</span><span class="p">,</span> <span class="n">BuidlRequest</span><span class="p">);</span>

        <span class="c1">//questo è il modo più semplice per controllare che la build sia andata a buon fine</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">buildResult</span><span class="p">.</span><span class="n">OverallResult</span> <span class="p">==</span> <span class="n">BuildResultCode</span><span class="p">.</span><span class="n">Success</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Build eseguita correttamente&quot;</span><span class="p">);</span>
            <span class="n">result</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
            <span class="c1">//a volte succede che l&#39;exception sia null</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">buildResult</span><span class="p">.</span><span class="n">Exception</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Build fallita: lista errori non disponibile&quot;</span><span class="p">);</span>
            <span class="k">else</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Build fallita: &quot;</span> <span class="p">+</span> <span class="n">buildResult</span><span class="p">.</span><span class="n">Exception</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Build Fallita: &quot;</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Quando si è in cerca di soluzioni relative all'ambiente .NET, consiglio
di evitare come la peste tutto quello che nell'url ha "msdn".<br>
Rispondono alle discussioni esclusivamente per aumentare il loro post
count nella speranza di ottenere qualche punto per poi bullarsi di
essere "MSMVP", un titolo che mi sembra che venga dato assolutamente a
caso.<br>
Si segnano come risposte i loro post inutili, aumentandosi il rank da
soli.</p>
<p>"Non mi builda la soluzione"<br>
"Hai provato a buildare?"<br>
"Ma ho appena detto che..."<br>
"Ma se buildi da console?"<br>
"Ma veramente..."<br>
"La soluzione ti builda?"<br>
"..."</p>
<p>---<em>"La soluzione ti builda?" è stata segnata come risposta al thread</em></p>
<p>E ricordate, se avrete a che fare con il supporto msdn sappiate che
sarete nel torto a prescindere.<br>
Visual Studio non ha bachi, il problema sarà sicuramente sempre colpa
vostra.</p>
<p><img alt="mabaffanculo" src="/images/orsobaffanculo.png"></p>
        </div>
        <div class="post_list">
            <div class="entry-social">
                <span class="twitter"><a target="_blank" rel="nofollow"
                                             onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;"
                                             title="Twitter"
                                             href="https://twitter.com/share?url=https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/&text=Build di una solution da codice&via="><img
                            src="https://ildoc.it/theme/pelican-blue/static/images/icons/twitter-s.png"></a></span>

                <span class="gplus"><a target="_blank" title="Google +"
                                           href="https://plus.google.com/share?url=https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/&hl=fr"
                                           rel="nofollow"
                                           onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ildoc.it/theme/pelican-blue/static/images/icons/google-s.png"></a></span>

                <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow"
                                                onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;"
                                                href="https://www.facebook.com/sharer.php?u=https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/&t=Build di una solution da codice"><img
                                src="https://ildoc.it/theme/pelican-blue/static/images/icons/facebook-s.png"></a></span>

                <a target="_blank" title="Linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/&title=Build di una solution da codice"
                    rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ildoc.it/theme/pelican-blue/static/images/icons/linkedin-s.png"></a>

                <span class="mail"><a
                            href="mailto:?subject=Build di una solution da codice&amp;body=Viens découvrir un article à propos de [Build di una solution da codice] sur le site de Doc. https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/"
                            title="Share by Email" target="_blank"><img
                            src="https://ildoc.it/theme/pelican-blue/static/images/icons/mail-s.png"></a></span>
            </div>
        </div>
        <div class="comments">
            <h2>Comments !</h2>
            <div id="disqus_thread"></div>
            <script>
                var disqus_config = function () {
                    this.page.url = "https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/";
                    this.page.identifier = "https://ildoc.it/2014/03/20/build-di-una-solution-da-codice/";
                };
                (function () {
                    var d = document,
                        s = d.createElement('script');
                    s.src = 'https://ildoc.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                })();
            </script>
        </div>
    </article>
</section>
    </article>

    <!-- Footer -->
    <footer>
        <p>
            Blog powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
            Theme <a href="https://github.com/parbhat/pelican-blue">Pelican-Blue</a> by <a href="https://parbhatpuri.com/">@parbhat</a>.
        </p>
    </footer>
 
</body>

</html>